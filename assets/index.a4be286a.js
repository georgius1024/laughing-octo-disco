var Z=Object.defineProperty,U=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var J=(e,i,n)=>i in e?Z(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n,g=(e,i)=>{for(var n in i||(i={}))q.call(i,n)&&J(e,n,i[n]);if(H)for(var n of H(i))Q.call(i,n)&&J(e,n,i[n]);return e},y=(e,i)=>U(e,W(i));import{o as x,c as C,a,n as L,r as M,b as $,t as E,d as p,e as X,F as j,f as w,g as A,w as b,h as tt}from"./vendor.bb3b4b1c.js";const et=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))l(h);new MutationObserver(h=>{for(const t of h)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function n(h){const t={};return h.integrity&&(t.integrity=h.integrity),h.referrerpolicy&&(t.referrerPolicy=h.referrerpolicy),h.crossorigin==="use-credentials"?t.credentials="include":h.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(h){if(h.ep)return;h.ep=!0;const t=n(h);fetch(h.href,t)}};et();var Y=(e,i)=>{const n=e.__vccOpts||e;for(const[l,h]of i)n[l]=h;return n};const it={props:["fromX","fromY","toX","toY","stroke"],computed:{padding(){return this.stroke*2},left(){return(this.fromX<this.toX?this.fromX:this.toX)-this.padding},top(){return(this.fromY<this.toY?this.fromY:this.toY)-this.padding},width(){return Math.abs(this.fromX-this.toX)+this.padding*2},height(){return Math.abs(this.fromY-this.toY)+this.padding*2},viewBox(){return`0 0 ${this.width} ${this.height}`},x1(){return this.fromX<this.toX?this.padding:this.width-this.padding},y1(){return this.fromY<this.toY?this.padding:this.height-this.padding},x2(){return this.fromX<this.toX?this.width-this.padding:this.padding},y2(){return this.fromY<this.toY?this.height-this.padding:this.padding},black(){return"#777"},style(){return{position:"absolute",left:`${this.left}px`,top:`${this.top}px`,zIndex:10}}}},rt=["width","height","viewBox"],nt=["x1","y1","x2","y2","stroke","stroke-width"],st=["cx","cy","r","stroke"],ot={id:"triangle",viewBox:"0 0 10 10",refX:"10",refY:"5",markerUnits:"strokeWidth",markerHeight:"4",orient:"auto"},ht=["fill"],lt=["cx","cy","r","stroke"];function ct(e,i,n,l,h,t){return x(),C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"connector",width:t.width,height:t.height,viewBox:t.viewBox,style:L(t.style)},[a("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:t.black,"stroke-width":n.stroke,"marker-end":"url(#triangle)"},null,8,nt),a("circle",{cx:t.x1,cy:t.y1,r:n.stroke,stroke:t.black,fill:"white","stroke-width":"2"},null,8,st),a("marker",ot,[a("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:t.black},null,8,ht)]),a("circle",{cx:t.x2,cy:t.y2,r:n.stroke,stroke:t.black,fill:"white","stroke-width":"2"},null,8,lt)],12,rt)}var at=Y(it,[["render",ct]]);const dt={props:["fromX","fromY","toX","toY","stroke","radius"],computed:{isRight(){return this.toX>this.fromX},padding(){return this.stroke*2},left(){return(this.fromX<this.toX?this.fromX:this.toX)-this.padding},top(){return(this.fromY<this.toY?this.fromY:this.toY)-this.padding},width(){return Math.abs(this.fromX-this.toX)+this.padding*2},height(){return Math.abs(this.fromY-this.toY)+this.padding*2},viewBox(){return`0 0 ${this.width} ${this.height}`},x1(){return this.fromX<this.toX?this.padding:this.width-this.padding},y1(){return this.fromY<this.toY?this.padding:this.height-this.padding},x2(){return this.fromX<this.toX?this.width-this.padding:this.padding},y2(){return this.fromY<this.toY?this.height-this.padding:this.padding},startingPoint(){return{x:this.fromX<this.toX?this.padding:this.width-this.padding,y:this.fromY<this.toY?this.padding:this.height-this.padding}},endingPoint(){return{x:this.fromX<this.toX?this.width-this.padding:this.padding,y:this.fromY<this.toY?this.height-this.padding:this.padding}},firstJunction(){return{x:this.endingPoint.x+(this.isRight?-this.radius:+this.radius),y:this.startingPoint.y}},secondJunction(){return{x:this.endingPoint.x,y:this.startingPoint.y+ +this.radius}},black(){return"#777"},style(){return{position:"absolute",left:`${this.left}px`,top:`${this.top}px`,zIndex:10}}}},ft=["width","height","viewBox"],ut=["x1","y1","x2","y2","stroke","stroke-width"],gt=["d","stroke","stroke-width"],yt=["x1","y1","x2","y2","stroke","stroke-width"],xt=["fill"],mt=a("path",{d:"M 0 0 L 10 5 L 0 10 z"},null,-1),kt=[mt],_t=["cx","cy","r","stroke"],vt=["cx","cy","r","stroke"];function Ct(e,i,n,l,h,t){return x(),C("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.width,height:t.height,viewBox:t.viewBox,style:L(t.style)},[a("line",{x1:t.startingPoint.x,y1:t.startingPoint.y,x2:t.firstJunction.x,y2:t.firstJunction.y,stroke:t.black,"stroke-width":n.stroke},null,8,ut),a("path",{d:`
      M ${t.firstJunction.x} ${t.firstJunction.y} 
      C ${t.firstJunction.x+(t.isRight?+n.radius:-n.radius)} ${t.firstJunction.y}  
        ${t.secondJunction.x} ${t.secondJunction.y}  
        ${t.secondJunction.x} ${t.secondJunction.y}
      `,stroke:t.black,"stroke-width":n.stroke,fill:"transparent","stroke-linecap":"round"},null,8,gt),a("line",{x1:t.secondJunction.x,y1:t.secondJunction.y,x2:t.endingPoint.x,y2:t.endingPoint.y,stroke:t.black,"stroke-width":n.stroke,"stroke-linecap":"round","marker-end":"url(#triangle)"},null,8,yt),a("marker",{id:"triangle",viewBox:"0 0 10 10",refX:"10",refY:"5",markerUnits:"strokeWidth",markerHeight:"4",orient:"auto",fill:t.black},kt,8,xt),a("circle",{cx:t.x1,cy:t.y1,r:n.stroke,stroke:t.black,fill:"white","stroke-width":"2"},null,8,_t),a("circle",{cx:t.x2,cy:t.y2,r:n.stroke,stroke:t.black,fill:"white","stroke-width":"2"},null,8,vt)],12,ft)}var wt=Y(dt,[["render",Ct]]);const pt={components:{LineConnector:at,SideConnector:wt},props:["id","x","y","size","color","content","leftConnection","rightConnection","rejected"],data(){return{dragOver:!1}},computed:{children(){return[this.leftConnection,this.rightConnection].filter(Boolean)},bothChildren(){return this.children.length===2},singleChild(){return this.children.length===1},coords(){return{x:this.left,y:this.top}},nodeStyle(){return{left:`${this.x}px`,top:`${this.y}px`,width:`${this.size}px`,height:`${this.size}px`,backgroundColor:this.color,fontSize:`${this.size*.75}px`}},centralConnectionPoint(){return{x:this.x+this.size/2,y:this.y+this.size}},leftConnectionPoint(){return{x:this.x,y:this.y+this.size/2}},rightConnectionPoint(){return{x:this.x+this.size,y:this.y+this.size/2}},singleChildConnection(){if(this.leftConnection)return this.leftConnection;if(this.rightConnection)return this.rightConnection}},methods:{startDrag(e){this.$emit("drag",this.id),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move";const i=this.size/2-e.offsetX,n=this.size/2-e.offsetY;e.dataTransfer.setData("id",this.id),e.dataTransfer.setData("shiftX",i),e.dataTransfer.setData("shiftY",n),this.dragging=!0},dragEnd(){this.dragging=!1,this.dragOver=!1},dragenter(e){this.dragOver=!0},dragleave(e){this.dragOver=!1},drop(){this.dragOver=!1}}},Xt=["textContent"];function bt(e,i,n,l,h,t){const c=M("LineConnector"),s=M("SideConnector");return x(),C(j,null,[a("div",{class:$(["node",{"drag-over":h.dragOver,rejected:n.rejected}]),style:L(t.nodeStyle),textContent:E(n.content),draggable:"true",onDragstart:i[0]||(i[0]=(...u)=>t.startDrag&&t.startDrag(...u)),onDragend:i[1]||(i[1]=(...u)=>t.dragEnd&&t.dragEnd(...u)),onDragenter:i[2]||(i[2]=(...u)=>t.dragenter&&t.dragenter(...u)),onDragleave:i[3]||(i[3]=(...u)=>t.dragleave&&t.dragleave(...u)),onDrop:i[4]||(i[4]=(...u)=>t.drop&&t.drop(...u))},null,46,Xt),t.singleChild?(x(),p(c,{key:0,fromX:t.centralConnectionPoint.x,fromY:t.centralConnectionPoint.y,toX:t.singleChildConnection.x,toY:t.singleChildConnection.y,stroke:"4"},null,8,["fromX","fromY","toX","toY"])):X("",!0),t.bothChildren?(x(),p(s,{key:1,fromX:t.leftConnectionPoint.x,fromY:t.leftConnectionPoint.y,toX:n.leftConnection.x,toY:n.leftConnection.y,stroke:"4",radius:"24"},null,8,["fromX","fromY","toX","toY"])):X("",!0),t.bothChildren?(x(),p(s,{key:2,fromX:t.rightConnectionPoint.x,fromY:t.rightConnectionPoint.y,toX:n.rightConnection.x,toY:n.rightConnection.y,stroke:"4",radius:"24"},null,8,["fromX","fromY","toX","toY"])):X("",!0)],64)}var Yt=Y(pt,[["render",bt],["__scopeId","data-v-3f04bed7"]]);function S(e){return{states:[e],position:1}}function St(e,i){const n=[...e.states.slice(0,e.position),i],l=n.length;return y(g({},e),{states:n,position:l})}function Pt({states:e,position:i}){return e[i-1]}function R({position:e}){return e>1}function F({states:e,position:i}){return i<e.length}function Dt(e){if(!R(e))throw new Error("Can't undo!");return y(g({},e),{position:e.position-1})}function zt(e){if(!F(e))throw new Error("Can't redo!");return y(g({},e),{position:e.position+1})}function Tt(e,i,n=!1){const l=2,h=e.reduce((r,o)=>y(g({},r),{[o.id]:g({},o)}),{}),t=h[i],c=r=>h[r],s=(r,o)=>{o(r),r.left&&s(c(r.left),o),r.right&&s(c(r.right),o)},u=(r,o)=>{r.left&&s(c(r.left),o),r.right&&s(c(r.right),o),o(r)},m=(r,o,f)=>{r.y=o,r.x=0,r.final=0,r.modifier=0,r.prevSibling=f,r.left&&m(c(r.left),o+1,null),r.right&&m(c(r.right),o+1,r.left||null)},_=r=>{r.left&&_(c(r.left)),r.right&&_(c(r.right)),r.prevSibling?r.x=r.x+c(r.prevSibling).x+l:r.x=0,r.left&&r.right?r.modifier=r.x-Math.ceil((c(r.right).x+c(r.left).x)/2):(r.left||r.right)&&(r.modifier=r.x)},v=(r,o)=>{r.final=r.x+o,r.left&&v(c(r.left),r.modifier+o),r.right&&v(c(r.right),r.modifier+o)},k=r=>{const o={};let f=0;return s(r,d=>{o[d.y]||(o[d.y]={}),o[d.y][d.final]&&f++,o[d.y][d.final]=1}),f},V=r=>{const o={};let f=0;return u(r,d=>{o[d.y]||(o[d.y]={});const z=o[d.y-1]&&o[d.y-1][d.final];z&&z.left!==d.id&&z.right!==d.id&&f++;const T=o[d.y+1]&&o[d.y+1][d.final];T&&T.left!==d.id&&T.right!==d.id&&f++,o[d.y][d.final]=d}),f},P=r=>{r.left&&P(c(r.left)),r.right&&P(c(r.right));let o=-1/0;r.left&&s(c(r.left),d=>{o=Math.max(o,+d.final)});let f=1/0;r.right&&s(c(r.right),d=>{f=Math.min(f,+d.final)}),o>=f&&s(c(r.right),d=>d.final+=o-f+l)},G=r=>{let o=1/0;s(r,f=>o=Math.min(+f.final,o)),o<0&&s(r,f=>f.final-=o)},K=r=>{s(r,o=>o.x=o.final)},D=r=>{if(r.left&&D(c(r.left)),r.right&&D(c(r.right)),r.left&&r.right){const o=+h[r.left].final,f=+h[r.right].final;r.final=(o+f)/2,n&&(r.final=Math.round(r.final))}else if(r.left){const o=h[r.left].final;o!==r.final&&(r.final=o)}else if(r.right){const o=h[r.right].final;o!==r.final&&(r.final=o)}};return m(t,0,null),_(t),v(t,0),G(t),(k(t)||V(t))&&(P(t),D(t)),K(t),h}const O=100,B=120,I=100,N=100,Lt={components:{TreeNode:Yt},data(){return{history:null,rejected:null,dragging:null,maxCol:0,maxRow:0}},computed:{scene(){return this.history?Pt(this.history):[]},undoable(){return Boolean(this.history&&R(this.history))},redoable(){return Boolean(this.history&&F(this.history))},hasUnsavedChanges(){return this.undoable},tree(){return Tt(this.scene,101)},map(){return this.scene.reduce((e,i)=>(e[i.id]=i,e),{})},nodeSize(){return 80},sceneOffsetX(){return I},sceneOffsetY(){return N},sceneStepX(){return O},sceneStepY(){return B},nextId(){return this.scene.reduce((e,i)=>e>i.id?e:i.id+1,101)},pickerItems(){return[{id:w(),color:"red",content:"\u{1F435}"},{id:w(),color:"navy",content:"\u{1F437}"},{id:w(),color:"yellow",content:"\u{1F436}"},{id:w(),color:"darkmagenta",content:"\u{1F431}"},{id:w(),color:"green",content:"\u{1F425}"},{id:w(),color:"purple",content:"\u{1F42E}"}]},initialScene(){return[{id:101,color:"red",content:"\u{1F435}",parent:null,left:102,right:103},{id:102,parent:101,color:"navy",content:"\u{1F437}",right:104},{id:103,parent:101,color:"yellow",content:"\u{1F436}"},{id:104,parent:102,color:"darkblue",content:"\u{1F431}"}]}},mounted(){const{scrollWidth:e,scrollHeight:i}=this.$refs.canvas;this.maxCol=Math.ceil((e-2*I)/O),this.maxRow=Math.ceil((i-2*N)/B),this.history=S([]);try{const n=JSON.parse(localStorage.scene);Array.isArray(n)&&(this.history=S(n))}catch{this.history=S(this.initialScene)}this.keyHandler=n=>{if(n.target.getAttribute("contenteditable")==="true")return;const h=n.code==="KeyZ"&&n.ctrlKey||n.code==="Backspace"&&n.ctrlKey,t=n.code==="KeyY"&&n.ctrlKey;h&&this.undoable&&(this.undo(),n.stopPropagation()),t&&this.redoable&&(this.redo(),n.stopPropagation())},document.addEventListener("keydown",this.keyHandler)},beforeDestroy(){document.removeEventListener("keydown",this.keyHandler)},methods:{save(){localStorage.scene=JSON.stringify(this.scene)},updateScene(e){this.history=St(this.history,e),this.save()},undo(){this.history=Dt(this.history),this.save()},redo(){this.history=zt(this.history),this.save()},clear(){this.history=S(this.initialScene)},gridToCanvasX(e){return e*this.sceneStepX+this.sceneOffsetX-this.nodeSize/2},gridToCanvasY(e){return e*this.sceneStepY+this.sceneOffsetY-this.nodeSize/2},connectionPoint(e){const i=this.tree[e];if(i)return{x:i.x*this.sceneStepX+this.sceneOffsetX,y:i.y*this.sceneStepY+this.sceneOffsetY-this.nodeSize/2}},snapToGrid(e,i){const n=+Math.round((e-I)/O),l=+Math.round((i-N)/B);return{col:n,row:l}},onDrop(e){const{offsetLeft:i,offsetTop:n,scrollLeft:l,scrollTop:h}=this.$refs.canvas,t=e.dataTransfer.getData("id"),c={x:e.pageX-i+l,y:e.pageY-n+h},{row:s,col:u}=this.snapToGrid(c.x,c.y),m=Object.values(this.tree).find(k=>k.x===u&&k.y===s);if(!m){this.reject(this.dragging);return}const _=this.pickerItems.find(k=>k.id===t);if(_)return this.placeNewNode(m,_);const v=this.scene.find(k=>k.id===+t);if(v)return this.moveNode(m,v)},onDelete(e){const i=+e.dataTransfer.getData("id"),n=this.scene.find(l=>l.left===i||l.right===i);if(!n){const l=this.scene.find(h=>h.id);this.reject(l.id);return}n.left===i&&this.deleteSubtree(n,!0),n.right===i&&this.deleteSubtree(n,!1)},placeNewNode(e,i){const n=e.id;if(e.left&&e.right)return this.reject(e.id),!1;const l=y(g({},i),{id:this.nextId,parent:n});e.left?e.right=l.id:e.left=l.id;const h=[...this.scene.map(t=>t.id===n?e:t),l];this.updateScene(h)},hasAsParent(e,i){if(e.parent===i.id)return!0;const n=this.map[e.parent];return n&&this.hasAsParent(n,i)},moveNode(e,i){if(e.left&&e.right){this.reject(e.id);return}if(e.id===i.id){this.reject(e.id);return}if(e.id===i.parent){this.reject(e.id);return}if(this.hasAsParent(e,i)){this.reject(e.id);return}const n=this.scene.map(l=>l.id===i.id?y(g({},l),{parent:e.id}):l.id===e.id?l.left?y(g({},l),{right:i.id}):y(g({},l),{left:i.id}):l.id===i.parent?l.left===i.id?y(g({},l),{left:void 0}):y(g({},l),{right:void 0}):l);this.updateScene(n)},reject(e){this.rejected=e,setTimeout(()=>{this.rejected=null},2e3)},deleteSubtree(e,i){const n=[],l=i?e.left:e.right,h=s=>{s.left&&h(this.map[s.left]),s.right&&h(this.map[s.right]),n.push(s.id)};h(this.map[l]);const t=g({},e);i?delete t.left:delete t.right;const c=this.scene.filter(s=>!n.includes(s.id)).map(s=>s.id===e.id?t:s);this.updateScene(c)}}},Mt={class:"layout"},jt={class:"header"},Ot=a("h1",null,"Draw binary tree",-1),Bt=a("a",{href:"https://github.com/georgius1024/laughing-octo-disco",target:"_blank"}," https://github.com/georgius1024/laughing-octo-disco ",-1),It=a("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[a("path",{fill:"currentColor",d:"M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z"})],-1),Nt=[It],Ht=["disabled"],Jt=a("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[a("path",{fill:"currentColor",d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})],-1),Et=[Jt],At=["disabled"],Rt=a("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[a("path",{fill:"currentColor",d:"M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"})],-1),Ft=[Rt],Vt={class:"picker"},Gt=a("div",{class:"separator"},null,-1),Kt=["textContent"];function Zt(e,i,n,l,h,t){const c=M("TreeNode");return x(),C("div",Mt,[a("header",jt,[Ot,Bt,a("button",{onClick:i[0]||(i[0]=(...s)=>t.clear&&t.clear(...s))},Nt),a("button",{onClick:i[1]||(i[1]=(...s)=>t.undo&&t.undo(...s)),disabled:!t.undoable},Et,8,Ht),a("button",{onClick:i[2]||(i[2]=(...s)=>t.redo&&t.redo(...s)),disabled:!t.redoable},Ft,8,At)]),a("aside",Vt,[(x(!0),C(j,null,A(t.pickerItems,(s,u)=>(x(),p(c,{id:s.id,x:60,y:20+u*100,size:t.nodeSize,color:s.color,content:s.content,key:s.id,rejected:s.id===h.rejected,onDrag:i[3]||(i[3]=m=>h.dragging=m)},null,8,["id","y","size","color","content","rejected"]))),128)),Gt,a("div",{class:"trash-can",onDrop:i[4]||(i[4]=(...s)=>t.onDelete&&t.onDelete(...s)),onDragover:i[5]||(i[5]=b(()=>{},["prevent"])),onDragenter:i[6]||(i[6]=b(()=>{},["prevent"])),textContent:E("\u{1F5D1}\uFE0F")},null,40,Kt)]),a("main",{class:"canvas",ref:"canvas",onDrop:i[8]||(i[8]=(...s)=>t.onDrop&&t.onDrop(...s)),onDragover:i[9]||(i[9]=b(()=>{},["prevent"])),onDragenter:i[10]||(i[10]=b(()=>{},["prevent"]))},[h.history?(x(!0),C(j,{key:0},A(t.tree,s=>(x(),p(c,{id:s.id,x:t.gridToCanvasX(s.x),y:t.gridToCanvasY(s.y),size:t.nodeSize,color:s.color,content:s.content,key:s.id,leftConnection:t.connectionPoint(s.left),rightConnection:t.connectionPoint(s.right),rejected:s.id===h.rejected,onDrag:i[7]||(i[7]=u=>h.dragging=u)},null,8,["id","x","y","size","color","content","leftConnection","rightConnection","rejected"]))),128)):X("",!0)],544)])}var Ut=Y(Lt,[["render",Zt]]);tt(Ut).mount("#app");
